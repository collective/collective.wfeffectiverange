<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="collective.wfeffectiverange">
<body>

<metal:custom_title fill-slot="content-title">
  <h1 class="documentFirstHeading" i18n:translate="heading_task_overview">Workflow Task Overview</h1>
</metal:custom_title>

<metal:content-core fill-slot="content-core">
<metal:block define-macro="content-core">


  <a href="${context/absolute_url}/++add++WFTaskEffective" class="btn btn-large pat-plone-modal" i18n:translate="label_add_wftaskeffective">Add Worfklow Effective Task</a>
  <tal:tasks_effective repeat="task_brain view/tasks_effective">

    <section tal:define="task task_brain/getObject;
                         transitions python:view.common_transitions(task);
                         objsinfo python:view.task_objects_info(task)">
      <header>
        <h2>
          <span>${task/title}</span>
          <input type="datetime" class="pat-pickadate" value="${task/task_date}"/>
          <select condition="transitions">
            <option value="" i18n:translate="option_make_selection">No transition selected</option>
            <option tal:repeat="transition transitions" value="${transition}">${transition}</option>
          </select>
          <span tal:condition="not:transitions" i18n:translate="no_common_transitions">No common transitions possible</span>
        </h2>
      </header>

      <tal:if condition="objsinfo">
      <table>
        <thead>
          <tr>
            <th>title</th>
            <th>workflows</th>
            <th>state</th>
          </tr>
        </thead>
        <tbody>
          <tal:loop repeat="ob objsinfo">
          <tr>
            <td class="state-${ob/state}"><a href="${ob/url}">${ob/title}</a></td>
            <td class="state-${ob/state}">${ob/workflows}</td>
            <td class="state-${ob/state}">${ob/state}</td>
          </tr>
          </tal:loop>
        </tbody>
      </table>
      </tal:if>
    </section>

  </tal:tasks_effective>


</metal:block>
</metal:content-core>

</body>
</html>
